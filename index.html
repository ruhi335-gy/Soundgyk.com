<!doctype html>
<html lang="hi">

<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Music Studio</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
:root{
  --bg:#0d0d0f;          /* Dark modern background */
  --card:#1a1a2e;        /* Slightly lighter for cards */
  --accent:#8b5cf6;      /* Modern purple accent */
  --muted:#b0b0b0;       /* Soft muted text */
  --glass: rgba(255,255,255,0.05);
  --shadow: rgba(139,92,246,0.3);
}

body{
  margin:0; 
  font-family:Inter; 
  background:var(--bg); 
  color:white; 
  padding-bottom:100px;
}

/* HEADER */
header{
  position:sticky; top:0; z-index:50;
  background:rgba(15,15,30,0.95);
  backdrop-filter:blur(8px);
  padding:12px 18px; 
  display:flex; 
  align-items:center; 
  gap:12px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
.hamb{
  width:44px;height:44px;
  border-radius:14px;
  background:var(--glass);
  display:grid;place-items:center;
  cursor:pointer; 
  transition:.2s;
}
.hamb:hover{background:var(--accent);}
.title{font-size:24px;font-weight:700; letter-spacing:1px;}

/* MENU PANEL */
.menu-panel{
  position:absolute;left:16px;top:60px;background:var(--card);
  padding:12px;border-radius:14px;display:none;flex-direction:column;
  box-shadow:0 6px 20px rgba(0,0,0,0.5);
}
.menu-panel a{
  color:white;text-decoration:none;padding:10px 14px;border-radius:12px;
  transition:.2s; font-weight:500;
}
.menu-panel a:hover{background:var(--accent); transform:scale(1.05);}

/* MINI PLAYER */
#headerMiniBar{
  position:fixed; top:70px; left:50%; transform:translateX(-50%);
  z-index:60;
  width:min(400px,95%);
  height:70px; padding:10px 16px;
  background:rgba(26,26,46,0.95);
  backdrop-filter:blur(12px);
  display:none; align-items:center; gap:12px;
  border-radius:16px;
  box-shadow:0 10px 25px var(--shadow);
  cursor:pointer;
  transition:.3s;
}
#headerMiniBar:hover{background:rgba(139,92,246,0.15);}
#headerMiniBar img{width:50px;height:50px;border-radius:14px;object-fit:cover}
#headerMiniBar .mInfo{flex:1; overflow:hidden}
#headerMiniBar .mInfo div:first-child{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
#headerMiniBar .mInfo div:last-child{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
#headerMiniBar .mControls{display:flex;gap:8px}
#headerMiniBar .mControls .iconBtn{
  width:38px;height:38px;font-size:14px;
  background:var(--glass); border-radius:12px;
  display:grid;place-items:center;
  transition:.2s; color:white;
}
#headerMiniBar .mControls .iconBtn:hover{background:var(--accent);}

/* SONG GRID */
.grid{
  margin-top:150px;
  display:grid;
  grid-template-columns:repeat(2, 1fr); /* 2 songs per row */
  gap:18px;padding:20px;
}
.card{
  background:var(--card); 
  padding:12px; 
  border-radius:18px;
  cursor:pointer; 
  transition:.3s; 
  box-shadow:0 6px 15px rgba(0,0,0,0.4);
  border: 1px solid rgba(255,255,255,0.08);
}
.card:hover{
  transform:translateY(-6px) scale(1.03); 
  box-shadow:0 12px 30px var(--shadow);
  border-color: var(--accent);
}
.thumb{
  width:100%;
  aspect-ratio:1/1;
  border-radius:16px;
  object-fit:cover; 
  transition: transform .3s;
}
.card:hover .thumb{
  transform:scale(1.05);
}

/* PLAYER OVERLAY */
#playerOverlay{
  position:fixed;inset:0;z-index:200;display:none;
  backdrop-filter:blur(14px);
  background:rgba(0,0,0,0.95);
  padding:20px; text-align:center;
  overflow-y:auto;
}
.playerTopBtns{position:absolute;top:12px;right:12px; display:flex;gap:10px;}
.iconBtn{
  width:50px;height:50px;border-radius:16px;
  background:var(--glass); display:grid;place-items:center; cursor:pointer; color:white;
  transition:.2s; font-size:18px;
}
.iconBtn:hover{background:var(--accent);}
.bigImg{width:min(420px,80%);border-radius:18px;margin-top:50px}
#playTitle{margin-top:20px;font-weight:700;font-size:24px;letter-spacing:1px;}
#playArtist{margin-top:5px;font-size:16px;color:var(--muted);}
.progress{
  width:min(720px,90%);
  height:10px;
  background:#333;
  border-radius:12px;
  margin:25px auto;
  overflow:hidden;
}
.progress i{height:100%; background:var(--accent); display:block; width:0%; transition:width .1s linear;}

/* FOOTER SEARCH BAR */
footer{
  position:fixed; bottom:0; left:0; right:0;
  background:rgba(15,15,30,0.95); backdrop-filter:blur(8px);
  padding:12px 20px; display:flex; align-items:center; gap:12px;
  border-top:1px solid rgba(255,255,255,0.08);
}
.footerSearch{
  flex:1; display:flex; background:rgba(255,255,255,0.05); border-radius:16px; padding:10px; align-items:center; gap:10px;
}
.footerSearch input{
  flex:1;
  background:transparent;
  border:none;
  outline:none;
  color:white;
  font-size:16px;
}
.footerSearch .icon{
  width:40px;height:40px;
  background:var(--glass);
  display:grid;place-items:center;
  border-radius:12px;
  color:white;
  transition:.2s
}
.footerSearch .icon:hover{background:var(--accent);}
</style>

</head>

<body>
<header>
  <div id="hamb" class="hamb"><i class="fa fa-bars"></i></div>
  <div class="title">Music Studio</div>
  <div id="menu" class="menu-panel">
    <a href="about.html">About</a>
    <a href="feedback.html">Feedback</a>
    <a href="social.html">Social</a>
  </div>
</header>

<!-- MINI PLAYER -->
<div id="headerMiniBar">
  <img id="hmImg">
  <div class="mInfo">
    <div id="hmTitle"></div>
    <div id="hmArtist"></div>
  </div>
  <div class="mControls">
    <div id="hmPrev" class="iconBtn"><i class="fa fa-backward"></i></div>
    <div id="hmPlay" class="iconBtn"><i class="fa fa-play"></i></div>
    <div id="hmNext" class="iconBtn"><i class="fa fa-forward"></i></div>
    <div id="hmClose" class="iconBtn"><i class="fa fa-xmark"></i></div>
  </div>
</div>

<!-- SONG GRID -->
<section class="grid" id="songsGrid"></section>

<!-- PLAYER OVERLAY -->
<div id="playerOverlay">

  <div class="playerTopBtns">
    <div id="minBtn" class="iconBtn"><i class="fa fa-window-minimize"></i></div>
    <div id="closeBtn" class="iconBtn"><i class="fa fa-xmark"></i></div>
  </div>

  <img id="playImg" class="bigImg">
  <h2 id="playTitle"></h2>
  <div style="color:var(--muted)" id="playArtist"></div>

  <div class="progress"><i id="progFill"></i></div>

  <div style="display:flex;justify-content:center;gap:12px;margin-top:20px; flex-wrap:wrap;">
    <div id="prevBtn" class="iconBtn"><i class="fa fa-backward"></i></div>
    <div id="playPause" class="iconBtn"><i class="fa fa-play"></i></div>
    <div id="nextBtn" class="iconBtn"><i class="fa fa-forward"></i></div>
    <div id="shareBtn" class="iconBtn"><i class="fa fa-share-alt"></i></div>
    <div id="downloadBtn" class="iconBtn"><i class="fa fa-download"></i></div>
  </div>

  <audio id="audio"></audio>
</div>

<!-- FOOTER SEARCH -->
<footer>
  <div class="footerSearch">
    <div class="icon"><i class="fa fa-magnifying-glass"></i></div>
    <input id="searchInput" placeholder="Search songs, artists...">
    <div id="clearSearch" class="icon"><i class="fa fa-xmark"></i></div>
  </div>
</footer>

<script src="song.js"></script>

<script>
// SONG GRID RENDER
const grid = document.getElementById("songsGrid");
function renderSongs(list){
  grid.innerHTML = "";
  list.forEach((s,i)=>{
    const c = document.createElement("div");
    c.className = "card";
    c.innerHTML = `
      <img class='thumb' src='${s.img}'>
      <div style="margin-top:8px;font-weight:600">${s.title}</div>
      <div style="color:var(--muted);font-size:13px">${s.artist}</div>`;
    c.onclick = () => playSongFromGrid(i); // click → auto play
    grid.appendChild(c);
  });
}
renderSongs(songs);

// PLAYER VARIABLES
const overlay = document.getElementById("playerOverlay");
const audio = document.getElementById("audio");
const playImg = document.getElementById("playImg");
const playTitle = document.getElementById("playTitle");
const playArtist = document.getElementById("playArtist");
const playPause = document.getElementById("playPause");
const progFill = document.getElementById("progFill");
let idxPlaying = 0, isPlaying = false;
const mini = document.getElementById("headerMiniBar");

// AUDIO FUNCTIONS
function playAudio(){
  audio.play();
  isPlaying = true;
  playPause.innerHTML = '<i class="fa fa-pause"></i>';
  document.getElementById("hmPlay").innerHTML = '<i class="fa fa-pause"></i>';
}
function pauseAudio(){
  audio.pause();
  isPlaying = false;
  playPause.innerHTML = '<i class="fa fa-play"></i>';
  document.getElementById("hmPlay").innerHTML = '<i class="fa fa-play"></i>';
}

audio.ontimeupdate = () => {
  if(audio.duration){
    progFill.style.width = ((audio.currentTime/audio.duration)*100)+"%";
  }
}

// MINI PLAYER FUNCTIONS
function showMini(){
  const s = songs[idxPlaying];
  document.getElementById("hmImg").src = s.img;
  document.getElementById("hmTitle").textContent = s.title;
  document.getElementById("hmArtist").textContent = s.artist;
  mini.classList.add("show");
}
function hideMini(){
  mini.classList.remove("show");
}

// FULL PLAYER FUNCTIONS (AUTOPLAY ON OPEN)
function showFullPlayer(){
  const s = songs[idxPlaying];
  overlay.style.display = "block";
  setTimeout(()=> overlay.classList.add("show"),50);
  playImg.src = s.img;
  playTitle.textContent = s.title;
  playArtist.textContent = s.artist;
  audio.src = s.src;
  audio.currentTime = 0;
  audio.play();        // auto play
  isPlaying = true;
  playPause.innerHTML = '<i class="fa fa-pause"></i>';
  document.getElementById("hmPlay").innerHTML = '<i class="fa fa-pause"></i>';
  showMini();
}
function hideFullPlayer(){
  overlay.classList.remove("show");
  setTimeout(()=> overlay.style.display="none",300);
}

// SONG SELECT FROM GRID → AUTO PLAY
function playSongFromGrid(i){
  idxPlaying = i;
  showFullPlayer();
}

// MINI PLAYER SONG UPDATE WITHOUT UNMINIMIZE
function showSongInfoMini(i){
  const s = songs[i];
  idxPlaying = i;
  document.getElementById("hmImg").src = s.img;
  document.getElementById("hmTitle").textContent = s.title;
  document.getElementById("hmArtist").textContent = s.artist;
  audio.src = s.src;
  if(isPlaying) audio.play(); else audio.pause();
}

// MINI PLAYER BUTTONS
document.getElementById("hmPlay").onclick = e => { e.stopPropagation(); isPlaying ? pauseAudio() : playAudio(); }
document.getElementById("hmPrev").onclick = e => { e.stopPropagation(); idxPlaying=(idxPlaying-1+songs.length)%songs.length; showSongInfoMini(idxPlaying); }
document.getElementById("hmNext").onclick = e => { e.stopPropagation(); idxPlaying=(idxPlaying+1)%songs.length; showSongInfoMini(idxPlaying); }
document.getElementById("hmClose").onclick = e => { e.stopPropagation(); pauseAudio(); hideMini(); }

// MINI PLAYER CLICK (ONLY IMAGE/TITLE/ARTIST → OPEN FULL)
mini.addEventListener("click", e => {
  if(e.target.closest(".iconBtn")) return; // ignore button clicks
  showFullPlayer();
});

// FULL PLAYER BUTTONS
playPause.onclick = () => isPlaying ? pauseAudio() : playAudio();
document.getElementById("prevBtn").onclick = () => { idxPlaying=(idxPlaying-1+songs.length)%songs.length; showFullPlayer(); }
document.getElementById("nextBtn").onclick = () => { idxPlaying=(idxPlaying+1)%songs.length; showFullPlayer(); }
document.getElementById("minBtn").onclick = hideFullPlayer;
document.getElementById("closeBtn").onclick = () => { pauseAudio(); hideFullPlayer(); }

// SHARE BUTTON
document.getElementById("shareBtn").addEventListener("click", async () => {
  const s = songs[idxPlaying];
  if(!s.id){ alert("Song ID missing"); return; }
  const encodedTitle = encodeURIComponent(s.title);
  const shareURL = `${window.location.origin}${window.location.pathname}?song=${s.id}&title=${encodedTitle}`;
  if(navigator.share){ await navigator.share({title:s.title,text:"",url:shareURL}); }
  else { navigator.clipboard.writeText(shareURL); alert("Link copied:\n"+shareURL); }
});

// DOWNLOAD BUTTON
document.getElementById("downloadBtn").addEventListener("click", async () => {
  const s = songs[idxPlaying];
  const finalName = `soundgyx - ${s.title}.mp3`;
  try{
    const response = await fetch(s.src,{mode:"cors"});
    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = finalName;
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
  }catch(err){ alert("Download error: "+err); }
});

// SEARCH SYSTEM
document.getElementById("searchInput").oninput = e => {
  const q = e.target.value.toLowerCase();
  renderSongs(songs.filter(s => (s.title+" "+s.artist).toLowerCase().includes(q)));
}
document.getElementById("clearSearch").onclick = () => {
  document.getElementById("searchInput").value="";
  renderSongs(songs);
}

// MENU
const hamb=document.getElementById("hamb"); const menu=document.getElementById("menu"); let menuTimeout;
hamb.onclick=e=>{e.stopPropagation(); if(menu.style.display==="flex") closeMenu(); else{menu.style.display="flex"; clearTimeout(menuTimeout); menuTimeout=setTimeout(closeMenu,5000);}}
function closeMenu(){menu.style.display="none"; clearTimeout(menuTimeout);}
document.addEventListener("click", e=>{if(menu.style.display==="flex" && !menu.contains(e.target) && e.target!==hamb) closeMenu();})

// URL SONG SHOW
function checkURLSong(){
  const params = new URLSearchParams(window.location.search);
  const songId = params.get("song");
  if(!songId) return;
  const findSong = songs.find(x=>x.id==songId);
  if(findSong){
    idxPlaying = songs.indexOf(findSong);
    showFullPlayer();
  }
}
checkURLSong();
  

</script>

</body>
</html>
